---
title: 图片占位符
date: 2018-11-09 00:11:11
tags: ['react', 'onError']
summary:
---
这个主要是解决图片加载失败后，有一个默认的图片顶替他的位置，不至于尴尬的显示一张裂图


![屏幕快照 2018-11-08 17.11.36.png | center | 501x221](https://cdn.nlark.com/yuque/0/2018/png/115449/1541668323143-c42a3543-8f77-46d8-9a4e-be8924cf6dd2.png "")


所以我们的目标是这样的


![屏幕快照 2018-11-08 17.14.51.png | center | 500x221](https://cdn.nlark.com/yuque/0/2018/png/115449/1541668516079-0cf80af4-dc55-445d-9066-a32bdf5d9677.png "")


怎么处理

将其封装为一个组件
```javascript
import React, { Component } from 'react';
import PropTypes from 'prop-types';
// 占位图片
import { Occupy } from 'Utils/img';

export default class PageTab extends Component {
	static propTypes = {
		src: PropTypes.string.isRequired
	};
	constructor(props) {
        super(props);
		this.state = {
          src: props.src
	    }
  }
  
  // 图片加载异常 使用默认图片 
  handleImageErrored = () => {
    // 此时图片为base64格式，直接打包到代码中，一般不会出现该图片不存在的问题
    this.setState({
      src: Occupy
    })
  }

  render() {
    const { className, style } = this.props;
    return (
      <img 
        style={style} 
        className={className} 
        src={this.state.src} 
        onError={this.handleImageErrored} 
      />
    );
  }
}
```

使用Img组件
```javascript
import Img from 'components/Img';

<Img src={imgUrl} />
```

#### 原理
图片加载失败，将会触发img的onError事件，在此时修改src地址，替换掉失败的图片地址
