---
title: H5拖拽
date: 2018-11-26 22:10:36
tags: ['drag', 'drop']
summary:
---
### 设置元素为可拖放
```html
<div draggable="true"></div>
```

### ondragstart 和 setData()
ondragstart 开始拖动时触发
dataTransfer.setData() 方法设置被拖数据的数据类型和值
```javascript
drag(ev){
    const id = getParentNodeId(ev.target);
    ev.dataTransfer.setData("Text",id);
}
```

### <span data-type="color" style="color:rgb(36, 41, 46)"><span data-type="background" style="background-color:rgb(255, 255, 255)">ondragover</span></span>
该方法规定元素可以放置的地方
在可放置的区域内拖动时触发
```javascript
dragver(ev){
    ev.preventDefault();
}
```

### ondrop
松开鼠标放置时触发
```javascript
drop(ev){
    ev.preventDefault();
    // 获取setData设置的数据
    var data=ev.dataTransfer.getData("Text");
    if(!data)return;
    // DOM元素插入操作
    ev.target.appendChild(document.getElementById(data));
}
```

示例源码
```javascript
import React from 'react';

export default class Drag extends React.Component{

	constructor(props) {
	    super(props);
	    this.state = {
	    	
		}
	}

	render(){ 
		return (
		  	<div>
                <div 
                    style={{width:'500px',height:'300px',border:'1px solid #333'}} 
                    onDrop={this.drop} 
                    onDragOver={this.allowDrop}
                ></div>
                <div 
                    style={{width:'500px',height:'300px',border:'1px solid #333',padding:'20px'}} 
                    onDrop={this.drop} 
                    onDragOver={this.allowDrop}
                ></div>

                <div style={{display:'inline-block',padding:'5px'}} draggable="true" id="drag-1">
                    <img 
                        style={{width:'auto',height:'70px'}} 
                        src="http://n.sinaimg.cn/sinacn/w1080h1920/20180127/4389-fyqzcxh3793070.jpg" 
                        onDragStart={this.drag} 
                    />
                </div>
                <div style={{display:'inline-block',padding:'5px'}} draggable="true" id="drag-2">
                    <img 
                        style={{width:'auto',height:'70px'}} 
                        src="http://p2.ifengimg.com/cmpp/2016/11/19/11/9fcd51bc-ffe2-43ce-a49b-2e0b94e6f3d9_size32_w387_h535.jpg" 
                        onDragStart={this.drag} 
                    />
                </div>
                
		  	</div>
		) 
    }
    // 在可放置的区域内拖动
    allowDrop(ev){
        ev.preventDefault();
    }

    // 开始移动拖动
    drag(ev){
        const id = getParentNodeId(ev.target);
        ev.dataTransfer.setData("Text",id);
    }

    // 松开鼠标放置触发
    drop(ev){
        ev.preventDefault();
        var data=ev.dataTransfer.getData("Text");
        if(!data)return;
        ev.target.appendChild(document.getElementById(data));
    }
}
```



![粘贴图片.png | center | 322x530](https://cdn.nlark.com/yuque/0/2018/png/115449/1543332254499-8dd513c8-a32c-4cb3-8f99-6719375e47e4.png "")




![image.png | center | 329x441](https://cdn.nlark.com/yuque/0/2018/png/115449/1543332287691-38c97917-bde4-458c-9e2f-9278e458d3e5.png "")