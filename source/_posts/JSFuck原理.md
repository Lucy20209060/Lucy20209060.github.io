---
title: JSFuck原理
date: 2019-04-14 00:54:16
tags: JSFuck
summary:
---
JSFuck仅仅使用6种符号来编写代码，它们分别是( ) + ! [ ]，本文主要写jsfuck代码的生成原理
<a name="0c3319ea"></a>
### JSFuck示例
```
[][(![]+([]+[]))[+[]]+([![]]+[][[]])[[+!+[]]+[+[]]]+(![]+([]+[]))[!+[]+!+[]]+(!![]+([]+[]))[+[]]+(!![]+([]+[]))[+!+[]+!+[]+!+[]]+(!![]+([]+[]))[+!+[]]][([][(![]+([]+[]))[+[]]+([![]]+[][[]])[[+!+[]]+[+[]]]+(![]+([]+[]))[!+[]+!+[]]+(![]+([]+[]))[!+[]+!+[]]]+([]+[]))[+!+[]+!+[]+!+[]]+(!![]+[][(![]+([]+[]))[+[]]+([![]]+[][[]])[[+!+[]]+[+[]]]+(![]+([]+[]))[!+[]+!+[]]+(![]+([]+[]))[!+[]+!+[]]])[[+!+[]]+[+[]]]+([][[]]+([]+[]))[+!+[]]+(![]+([]+[]))[+!+[]+!+[]+!+[]]+(!![]+([]+[]))[+[]]+(!![]+([]+[]))[+!+[]]+([][[]]+([]+[]))[+[]]+([][(![]+([]+[]))[+[]]+([![]]+[][[]])[[+!+[]]+[+[]]]+(![]+([]+[]))[!+[]+!+[]]+(![]+([]+[]))[!+[]+!+[]]]+([]+[]))[+!+[]+!+[]+!+[]]+(!![]+([]+[]))[+[]]+(!![]+[][(![]+([]+[]))[+[]]+([![]]+[][[]])[[+!+[]]+[+[]]]+(![]+([]+[]))[!+[]+!+[]]+(![]+([]+[]))[!+[]+!+[]]])[[+!+[]]+[+[]]]+(!![]+([]+[]))[+!+[]]
]((![]+([]+[]))[+!+[]]+(![]+([]+[]))[!+[]+!+[]]+(!![]+([]+[]))[!+[]+!+[]+!+[]]+(!![]+([]+[]))[+!+[]]+(!![]+([]+[]))[+[]]+([][[]]+[][(![]+([]+[]))[+[]]+([![]]+[][[]])[[+!+[]]+[+[]]]+(![]+([]+[]))[!+[]+!+[]]+(![]+([]+[]))[!+[]+!+[]]])[[!+[]+!+[]]+[!+[]+!+[]]]+(+(+!+[]))+([+[]]+![]+[][(![]+([]+[]))[+[]]+([![]]+[][[]])[[+!+[]]+[+[]]]+(![]+([]+[]))[!+[]+!+[]]+(![]+([]+[]))[!+[]+!+[]]])[[!+[]+!+[]]+[+[]]])()
```
这么一大串其实就是
```javascript
eval('alert(1)')
```
在弄清如何转化之前，先罗列下基础的原理
<a name="false"></a>
### false
[]的布尔值为true，取反
```
![] ==> false
```
<a name="true"></a>
### true
```
!![] ==> true
```
<a name="undefined"></a>
### undefined
在js中数组的索引可以为负数和非整数，而在这种情况下会将索引转换成字符串，作为对象的属性访问，我们知道[]转换为字符串为空字符串，则上面等价于：[][""]。然而数组对象并没有名为""的属性，在js中访问一个对象并不存在的属性时，会给出undefined 
```
[][[]] ==> undefined
```
<a name="0"></a>
### 0
根据类型转换规则，[]转换为数字为0
```
+[] ==> 0
```
<a name="1"></a>
### 1
true转化为数字就是1
```
+!![] ==> 1
```
<a name="2"></a>
### 2
```
!![]+!![] ==> 2
```
<a name="10"></a>
### 10
[1]+[0] ==> 得到字符串"10"
```
[+!+[]]+[+[]] ==> "10"
```
<a name="9d4568c0"></a>
### ""
```
[]+[] ==> ""
```
<a name="66828ac3"></a>
### eval()
```
[]["filter"]["constructor"]( /*code*/ )() ==> eval(/*code*/)
```
<a name="a"></a>
### a
将false转化为字符串，取其第二个字母，后面的同理
```
(false+"")[1] ==> (!![]+[]+[])[1] ==> a
```
<a name="l"></a>
### l
```
(false+"")[2] ==> (![]+[]+[])[2] ==> l
```
<a name="e"></a>
### e
```
(true+"")[3] ==> (!![]+[]+[])[3] ==> e
```
<a name="r"></a>
### r
```
(true+"")[1] ==> (!![]+[]+[])[1] ==> r
```
<a name="t"></a>
### t
```
(true+"")[0] ==> (!![]+[]+[])[0] ==> t
```
<a name="i"></a>
### i
(""+undefined)[5] ==> "undefined"[5] ==> i<br />将undefined转化为字符串，取字符串"i"
```
([]+undefined)[5] ==> ([]+[][[]])[5] ==> i
```
<a name="f"></a>
### f
```
(false+"")[0] ==> (![]+[]+[])[0] ==> f
```
<a name="da6639bb"></a>
### ( 与 )
([]+[]['fill']) ==> "function fill() { [native code] }"
```
([]+[]['fill'])[13] ==> (
([]+[]['fill'])[14] ==> )
```
还有很多，就不一一介绍了
<a name="238e96d5"></a>
### alert(1)
先转化"alert(1)"这个字符串<br />a+l+e+r+t+(+1+)
```
(false+"")[1]+(false+"")[2]+(true+"")[3]+(true+"")[1]+(true+"")[0]+([]+[]['fill'])[13]+(+!![])+([]+[]['fill'])[14]
```
接下来，将<br />true ==> !![]<br />false ==> ![]<br />替换得到
```
(![]+"")[1]+(![]+"")[2]+(!![]+"")[3]+(!![]+"")[1]+(!![]+"")[0]+([]+[]['fill'])[13]+(+!![])+([]+[]['fill'])[14]
```
替换掉两个"fill"<br />fill ==> (![]+[]+[])[0]+([]+[][[]])[5]+(![]+[]+[])[2]+(![]+[]+[])[2]
```
(![]+"")[1]+(![]+"")[2]+(!![]+"")[3]+(!![]+"")[1]+(!![]+"")[0]+([]+[][(![]+[]+[])[0]+([]+[][[]])[5]+(![]+[]+[])[2]+(![]+[]+[])[2]])[13]+(+!![])+([]+[][(![]+[]+[])[0]+([]+[][[]])[5]+(![]+[]+[])[2]+(![]+[]+[])[2]])[14]
```
替换掉空字符串<br />"" ==> []+[]
```
(![]+[]+[])[1]+(![]+[]+[])[2]+(!![]+[]+[])[3]+(!![]+[]+[])[1]+(!![]+[]+[])[0]+([]+[][(![]+[]+[])[0]+([]+[][[]])[5]+(![]+[]+[])[2]+(![]+[]+[])[2]])[13]+(+!![])+([]+[][(![]+[]+[])[0]+([]+[][[]])[5]+(![]+[]+[])[2]+(![]+[]+[])[2]])[14]
```
替换掉其中的数字<br />0 ==> +[]<br />1 ==> +!![]<br />2 ==> !![]+!![]<br />3 ==> !![]+!![]+!![]<br />5 ==> !![]+!![]+!![]+!![]+!![]<br />"13" ==> (+!![])+(!![]+!![]+!![]+[])<br />"14" ==> (+!![])+(!![]+!![]+!![]+!![]+[])<br />[13]与["13"]效果相同
```
(![]+[]+[])[+!![]]+(![]+[]+[])[!![]+!![]]+(!![]+[]+[])[!![]+!![]+!![]]+(!![]+[]+[])[+!![]]+(!![]+[]+[])[+[]]+([]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(!![]+!![]+!![]+[])]+(+!![])+([]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(!![]+!![]+!![]+!![]+[])]
```
好了，我们到此已经得到了字符串"alert(1)"的转化<br />现在把它放入eval()函数中
```
[]["filter"]["constructor"]((![]+[]+[])[+!![]]+(![]+[]+[])[!![]+!![]]+(!![]+[]+[])[!![]+!![]+!![]]+(!![]+[]+[])[+!![]]+(!![]+[]+[])[+[]]+([]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(!![]+!![]+!![]+[])]+(+!![])+([]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(!![]+!![]+!![]+!![]+[])])()
```
执行上面的代码已经可以执行弹窗了<br />现在只剩下将"filter"和"constructor"转化了<br />filter ==> `(![]+[]+[])[+[]]`<br />+`([]+[][[]])[!![]+!![]+!![]+!![]+!![]]`<br />+`(![]+[]+[])[!![]+!![]]`<br />+`(!![]+[]+[])[+[]]`<br />+`(!![]+[]+[])[!![]+!![]+!![]]`<br />+`(!![]+[]+[])[+!![]]`

==> (![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(!![]+[]+[])[+[]]+(!![]+[]+[])[!![]+!![]+!![]]+(!![]+[]+[])[+!![]]

constructor ==> `([]["fill"]+"")[3]`<br />+`(true+[]["fill"])[10]`<br />+`(undefined+"")[1]`<br />+`(false+"")[3]`<br />+`(true+"")[0]`<br />+`(true+"")[1]`<br />+`(true+"")[2]`<br />+`([]["fill"]+"")[3]`<br />+`(true+"")[0]`<br />+`(true+[]["fill"])[10]`<br />+`(true+"")[1]`

==> `([][(![]+[]+[])[0]+([]+[][[]])[5]+(![]+[]+[])[2]+(![]+[]+[])[2]]+[]+[])[3]`<br />+`(!![]+[][(![]+[]+[])[0]+([]+[][[]])[5]+(![]+[]+[])[2]+(![]+[]+[])[2]])[10]`<br />+`([][[]]+[]+[])[1]`<br />+`(![]+[]+[])[3]`<br />+`(!![]+[]+[])[0]`<br />+`(!![]+[]+[])[1]`<br />+`(!![]+[]+[])[2]`<br />+`([][(![]+[]+[])[0]+([]+[][[]])[5]+(![]+[]+[])[2]+(![]+[]+[])[2]]+[]+[])[3]`<br />+`(!![]+[]+[])[0]`<br />+`(!![]+[][(![]+[]+[])[0]+([]+[][[]])[5]+(![]+[]+[])[2]+(![]+[]+[])[2]])[10]`<br />+`(!![]+[]+[])[1]`

==> `([][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]]+[]+[])[!![]+!![]+!![]]`<br />+`(!![]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(+[]+[])]`<br />+`([][[]]+[]+[])[+!![]]`<br />+`(![]+[]+[])[!![]+!![]+!![]]`<br />+`(!![]+[]+[])[+[]]`<br />+`(!![]+[]+[])[+!![]]`<br />+`(!![]+[]+[])[!![]+!![]]`<br />+`([][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]]+[]+[])[!![]+!![]+!![]]`<br />+`(!![]+[]+[])[+[]]`<br />+`(!![]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(+[]+[])]`<br />+`(!![]+[]+[])[+!![]]`

==> ([][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]]+[]+[])[!![]+!![]+!![]]+(!![]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(+[]+[])]+([][[]]+[]+[])[+!![]]+(![]+[]+[])[!![]+!![]+!![]]+(!![]+[]+[])[+[]]+(!![]+[]+[])[+!![]]+(!![]+[]+[])[!![]+!![]]+([][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]]+[]+[])[!![]+!![]+!![]]+(!![]+[]+[])[+[]]+(!![]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(+[]+[])]+(!![]+[]+[])[+!![]]

```
[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(!![]+[]+[])[+[]]+(!![]+[]+[])[!![]+!![]+!![]]+(!![]+[]+[])[+!![]]][([][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]]+[]+[])[!![]+!![]+!![]]+(!![]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(+[]+[])]+([][[]]+[]+[])[+!![]]+(![]+[]+[])[!![]+!![]+!![]]+(!![]+[]+[])[+[]]+(!![]+[]+[])[+!![]]+(!![]+[]+[])[!![]+!![]]+([][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]]+[]+[])[!![]+!![]+!![]]+(!![]+[]+[])[+[]]+(!![]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(+[]+[])]+(!![]+[]+[])[+!![]]]((![]+[]+[])[+!![]]+(![]+[]+[])[!![]+!![]]+(!![]+[]+[])[!![]+!![]+!![]]+(!![]+[]+[])[+!![]]+(!![]+[]+[])[+[]]+([]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(!![]+!![]+!![]+[])]+(+!![])+([]+[][(![]+[]+[])[+[]]+([]+[][[]])[!![]+!![]+!![]+!![]+!![]]+(![]+[]+[])[!![]+!![]]+(![]+[]+[])[!![]+!![]]])[(+!![])+(!![]+!![]+!![]+!![]+[])])()
```
转化成功<br />可是<br />我已经不想再碰这个恶心的东西了