<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Lucy"><title>js闭包 · 长剑腥腥挂壁</title><meta name="description" content="1.变量作用域要理解闭包，先要理解js的变量作用域：全局变量，局部变量函数内部可以直接读取全局变量，但在函数外部无法读取函数内部的局部变量函数内部申明变量的时候，需使用var等，否则申明的是全局变量
2.如何从外部读取函数内部的局部变量123456789function F1()&amp;#123;    "><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/logo-2.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo-2.png" style="width:127px;"><h3 title=""><a href="/">长剑腥腥挂壁</a></h3></div></div><ul class="social-links"></ul></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/logo-2.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>js闭包</a></h3></div><div class="post-content"><h3 id="1-变量作用域"><a href="#1-变量作用域" class="headerlink" title="1.变量作用域"></a>1.变量作用域</h3><p>要理解闭包，先要理解js的变量作用域：全局变量，局部变量<br>函数内部可以直接读取全局变量，但在函数外部无法读取函数内部的局部变量<br>函数内部申明变量的时候，需使用var等，否则申明的是全局变量</p>
<h3 id="2-如何从外部读取函数内部的局部变量"><a href="#2-如何从外部读取函数内部的局部变量" class="headerlink" title="2.如何从外部读取函数内部的局部变量"></a>2.如何从外部读取函数内部的局部变量</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">F1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> n = <span class="number">999</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">F2</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(n); <span class="comment">// 999</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> F2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> F1Tem = F1();</span><br><span class="line">F1Tem();</span><br></pre></td></tr></table></figure>
<p>函数F2读取函数F1的局部变量，只要把F2作为返回值，就能在F1外读取它的局部变量</p>
<h3 id="3-闭包的概念"><a href="#3-闭包的概念" class="headerlink" title="3.闭包的概念"></a>3.闭包的概念</h3><p>闭包就是能够读取其他函数内部变量的函数，js中只有函数内部的子函数才能读取局部变量，所以闭包可以理解为“定义在一个函数内部的函数”。在本质上，闭包是将函数内部和函数外部连接起来的桥梁。<br>F2函数就是闭包函数。</p>
<h3 id="4-闭包的特点"><a href="#4-闭包的特点" class="headerlink" title="4.闭包的特点"></a>4.闭包的特点</h3><ul>
<li>函数嵌套函数</li>
<li>内部函数可以访问外部函数的变量</li>
<li>参数和变量不会被回收</li>
</ul>
<h3 id="5-闭包的用途"><a href="#5-闭包的用途" class="headerlink" title="5.闭包的用途"></a>5.闭包的用途</h3><p>一个是可以读取函数内部的变量，另一个是让这些变量的值始终保持在内存中，不会在F1调用后自动清除</p>
<h3 id="6-闭包的缺陷"><a href="#6-闭包的缺陷" class="headerlink" title="6.闭包的缺陷"></a>6.闭包的缺陷</h3><p>常驻内存会增大内存的使用量，并且使用不当很容易造成内存泄露<br>如果不是因为特殊原因需要闭包，在没有必要的情况下，在其他函数中创建函数是不明智的，因为闭包对脚本性能具有负面影响，包括处理速度和内存的消耗</p>
<h3 id="7-注意点"><a href="#7-注意点" class="headerlink" title="7.注意点"></a>7.注意点</h3><ul>
<li>由于闭包会使得函数中的变量被保存在内存中，内存消耗很大，所以不能滥用闭包，否则会造成网页的性能问题，在IE中可能导致内存泄露。解决方法就是在退出函数之前，将不使用的局部变量全部删除</li>
<li>闭包会在父函数外部，改变父函数内部变量的值。所以你把父函数当作对象使用，把闭包当作它的公用方法，把内部变量当作它的私有属性，这时一定要小心，不能随意改变父函数内部变量的值。</li>
</ul>
<h3 id="8-面试题"><a href="#8-面试题" class="headerlink" title="8.面试题"></a>8.面试题</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params">n,o</span>)</span>&#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">'n:'</span>+n+<span class="string">' , o:'</span>+o);</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		fun: <span class="function"><span class="keyword">function</span>(<span class="params">m</span>)</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> fun(m,n);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = fun(<span class="number">0</span>);  <span class="comment">// n:0 , o:undefined</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	a = &#123;</span></span><br><span class="line"><span class="comment">		fun: function(m)&#123;</span></span><br><span class="line"><span class="comment">			return fun(m,n);</span></span><br><span class="line"><span class="comment">		&#125;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">a.fun(<span class="number">1</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	n = 0;</span></span><br><span class="line"><span class="comment">	m = 1;</span></span><br><span class="line"><span class="comment">	=&gt; n:1 , o:0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">a.fun(<span class="number">2</span>);        <span class="comment">// =&gt; n:2 , o:0</span></span><br><span class="line">a.fun(<span class="number">3</span>);        <span class="comment">// =&gt; n:3 , o:0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//				m=1=n		  m=3=n	</span></span><br><span class="line"><span class="comment">//				n=0=o		  n=2=o</span></span><br><span class="line"><span class="keyword">var</span> b = fun(<span class="number">0</span>).fun(<span class="number">1</span>).fun(<span class="number">2</span>).fun(<span class="number">3</span>);</span><br><span class="line"><span class="comment">//		n=0     		m=2=n</span></span><br><span class="line"><span class="comment">//		o=undefined		n=1=o</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = fun(<span class="number">0</span>).fun(<span class="number">1</span>);  <span class="comment">// 同上</span></span><br><span class="line"><span class="comment">// c.fun(2);        // m=2=n , n=1=o</span></span><br><span class="line"><span class="comment">// c.fun(3);        // m=3=n , n=1=o</span></span><br></pre></td></tr></table></figure></div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-11-22</span><i class="fa fa-tag"></i><a class="tag" href="/tags/js/" title="js">js </a><a class="tag" href="/tags/闭包/" title="闭包">闭包 </a></div></div></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2018/11/23/js的DOM操作/" title="js的DOM操作">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/11/21/Parcel搭建React项目/" title="Parcel搭建React项目">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>