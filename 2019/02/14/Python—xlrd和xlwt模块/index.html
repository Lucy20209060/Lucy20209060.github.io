<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Lucy"><title>Python—xlrd和xlwt模块 · 长剑腥腥挂壁</title><meta name="description" content="python操作excel主要用到xlrd和xlwt这两个库，即xlrd是读excel，xlwt是写excel的库
安装12pip install xlrdpip install xlwt
导入12import xlrd # 读import xlwt # 写
读取excel文件xlrd.open_w"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/logo-2.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo-2.png" style="width:127px;"><h3 title><a href="/">长剑腥腥挂壁</a></h3></div></div><ul class="social-links"></ul></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/logo-2.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Python—xlrd和xlwt模块</a></h3></div><div class="post-content"><p>python操作excel主要用到xlrd和xlwt这两个库，即<code>xlrd</code>是读excel，<code>xlwt</code>是写excel的库</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install xlrd</span><br><span class="line">pip install xlwt</span><br></pre></td></tr></table></figure>
<h3 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlrd <span class="comment"># 读</span></span><br><span class="line"><span class="keyword">import</span> xlwt <span class="comment"># 写</span></span><br></pre></td></tr></table></figure>
<h3 id="读取excel文件"><a href="#读取excel文件" class="headerlink" title="读取excel文件"></a>读取excel文件</h3><p>xlrd.open_workbook(filename)<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文件名以及路径，如果路径或者文件名有中文给前面加一个r拜师原生字符</span></span><br><span class="line">excel = xlrd.open_workbook(filename)</span><br></pre></td></tr></table></figure></p>
<h4 id="获取所有工作表名称"><a href="#获取所有工作表名称" class="headerlink" title="获取所有工作表名称"></a>获取所有工作表名称</h4><p>sheet_names()<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开excel表格</span></span><br><span class="line">excel = xlrd.open_workbook(<span class="string">'/Users/lc/Desktop/test.xlsx'</span>)</span><br><span class="line"><span class="keyword">print</span> (excel.sheet_names())  <span class="comment"># ['工作表1', '工作表2']</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查某个sheet是否导入完毕，返回True或False</span></span><br><span class="line">excel.sheet_loaded(<span class="string">'table2'</span>) <span class="comment"># sheet_name or indx</span></span><br></pre></td></tr></table></figure></p>
<h4 id="获取工作表的三种方式"><a href="#获取工作表的三种方式" class="headerlink" title="获取工作表的三种方式"></a>获取工作表的三种方式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">table = excel.sheets()[<span class="number">0</span>]                 <span class="comment"># 通过索引顺序获取</span></span><br><span class="line">table = excel.sheet_by_index(<span class="number">0</span>))					 <span class="comment"># 通过索引顺序获取</span></span><br><span class="line">table = excel.sheet_by_name(<span class="string">'table1'</span>)		 <span class="comment"># 通过名称获取</span></span><br></pre></td></tr></table></figure>
<h4 id="行获取"><a href="#行获取" class="headerlink" title="行获取"></a>行获取</h4><p>nrows 获取工作表有效行<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">table1 = data.sheets()[<span class="number">0</span>]</span><br><span class="line">nrows = table1.nrows <span class="comment"># 获取该工作表的有效行</span></span><br></pre></td></tr></table></figure></p>
<p>row(indx) 获取indx行的数据<br>row_slice(indx, start_indx, end_indx) 截取indx行的一段数据包括start_indx，不包括end_indx<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取某行的数据 返回由该行中所有的单元格对象组成的列表</span></span><br><span class="line">rowx = table.row(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 第二行数据</span></span><br><span class="line">print(rowx) <span class="comment"># [text:'2A', empty:'', text:'2C']</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 截取某行的一段数据</span></span><br><span class="line">rowx = table.row_slice(<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>)</span><br><span class="line">print(rowx) <span class="comment"># [text:'1A', empty:'']</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/115449/1550039245681-75a081a9-9686-488a-8b78-ad2bc5b4ada8.png#align=left&amp;display=inline&amp;height=185&amp;linkTarget=_blank&amp;name=20190213142712.png&amp;originHeight=185&amp;originWidth=252&amp;size=17598&amp;width=252" alt="20190213142712.png"></p>
<p>row_len(indx) 获取indx行的有效数据长度<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">table.row_len(<span class="number">0</span>) <span class="comment"># 3</span></span><br></pre></td></tr></table></figure></p>
<p>row_values(indx, start_indx, end_indx)获取indx行指定单元格范围内数据组成的列表<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">values = table.row_values(<span class="number">0</span>,<span class="number">0</span>,<span class="number">3</span>)</span><br><span class="line">print(values) <span class="comment"># ['1A', '', '']</span></span><br></pre></td></tr></table></figure></p>
<p>get_rows() 获取所有行的生成器<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> table.get_rows():</span><br><span class="line">    print(item)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [text:'1A', empty:'', empty:'']</span></span><br><span class="line"><span class="comment"># [text:'2A', empty:'', text:'2C']</span></span><br><span class="line"><span class="comment"># [text:'3A', empty:'', empty:'']</span></span><br><span class="line"><span class="comment"># [empty:'', empty:'', text:'4C']</span></span><br><span class="line"><span class="comment"># [empty:'', text:'5B', empty:'']</span></span><br><span class="line"><span class="comment"># [empty:'', empty:'', empty:'']</span></span><br><span class="line"><span class="comment"># [empty:'', empty:'', empty:'']</span></span><br><span class="line"><span class="comment"># [empty:'', empty:'', empty:'']</span></span><br><span class="line"><span class="comment"># [empty:'', text:'9B', empty:'']</span></span><br></pre></td></tr></table></figure></p>
<p>row_types(indx, start_indx, end_indx) 获取indx行指定范围内单元格的类型</p>
<table>
<thead>
<tr>
<th>返回值</th>
<th>类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>empty</td>
</tr>
<tr>
<td>1</td>
<td>string</td>
</tr>
<tr>
<td>2</td>
<td>number</td>
</tr>
<tr>
<td>3</td>
<td>date</td>
</tr>
<tr>
<td>4</td>
<td>boolean</td>
</tr>
<tr>
<td>5</td>
<td>error</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">types = table.row_types(<span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">print(types) <span class="comment"># [1, 0, 1]</span></span><br></pre></td></tr></table></figure>
<h4 id="列获取"><a href="#列获取" class="headerlink" title="列获取"></a>列获取</h4><p>ncols 获取列数<br>col(indx) 获取indx列的数据<br>col_slice(indx, start_indx, end_indx) 截取indx列的一段数据包括start_indx，不包括end_indx<br>col_values(indx, start_indx, end_indx)获取indx列指定单元格范围内数据组成的列表col_types(indx, start_indx, end_indx) 获取indx列指定范围内单元格的类型</p>
<h4 id="单元格获取"><a href="#单元格获取" class="headerlink" title="单元格获取"></a>单元格获取</h4><p>cell(rowx, colx) 获取rowx行colx列的单元对象<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cell = table.cell(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">print(cell) <span class="comment"># text:'1A'</span></span><br></pre></td></tr></table></figure></p>
<p>cell_value(rowx,colx) 获取rowx行colx列的值<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cell = table.cell_value(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">print(cell) <span class="comment"># '1A'</span></span><br></pre></td></tr></table></figure></p>
<p>cell_type(rowx,colx) 获取rowx行colx列的类型<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cell = table.cell_type(<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">print(cell) <span class="comment"># 1</span></span><br></pre></td></tr></table></figure></p>
<h3 id="操作excel文件"><a href="#操作excel文件" class="headerlink" title="操作excel文件"></a>操作excel文件</h3><h4 id="新建表格"><a href="#新建表格" class="headerlink" title="新建表格"></a>新建表格</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xlwt</span><br><span class="line"><span class="comment"># 创建excel</span></span><br><span class="line">file = xlwt.Workbook()</span><br><span class="line"><span class="comment"># 创建工作表</span></span><br><span class="line">table = file.add_sheet(<span class="string">'工作表1'</span>,cell_overwrite_ok=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 写数据</span></span><br><span class="line">table.write(<span class="number">0</span>,<span class="number">0</span>,<span class="string">'test'</span>)</span><br><span class="line"><span class="comment"># 保存 默认保存在当前目录</span></span><br><span class="line">file.save(<span class="string">'/Users/lc/Desktop/demo.xls'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="设置字体、颜色与单元格背景"><a href="#设置字体、颜色与单元格背景" class="headerlink" title="设置字体、颜色与单元格背景"></a>设置字体、颜色与单元格背景</h4><p>write_merge(x, x + m, y, y + n, string, style) 合并单元格 x表示行，y表示列，m表示跨行个数，n表示跨列个数，string表示要写入的单元格内容，style表示单元格样式<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x00</span>,<span class="number">0xff</span>):</span><br><span class="line">  	<span class="comment"># 初始化样式</span></span><br><span class="line">    style = xlwt.XFStyle()   </span><br><span class="line">    </span><br><span class="line">    font = xlwt.Font()   <span class="comment"># 创建一个文本格式，包括字体、字号和颜色样式特性    </span></span><br><span class="line">    font.name = <span class="string">u'微软雅黑'</span>  <span class="comment"># 设置其字体为微软雅黑     </span></span><br><span class="line">    font.colour_index = i+<span class="number">1</span>  <span class="comment"># 设置其字体颜色     </span></span><br><span class="line">    font.bold = <span class="literal">True</span>  </span><br><span class="line">    font.height = <span class="number">400</span> </span><br><span class="line">    style.font = font </span><br><span class="line"></span><br><span class="line">    pattern = xlwt.Pattern()   <span class="comment"># 创建一个模式     </span></span><br><span class="line">    pattern.pattern = xlwt.Pattern.SOLID_PATTERN  </span><br><span class="line">		<span class="comment"># 设置单元格背景</span></span><br><span class="line">    pattern.pattern_fore_colour = i</span><br><span class="line">    <span class="comment"># 设置单元格背景颜色 0 = Black, 1 = White, 2 = Red, 3 = Green, 4 = Blue, 5 = Yellow, 6 = Magenta, the list goes on...</span></span><br><span class="line">    style.pattern = pattern</span><br><span class="line"></span><br><span class="line">    table.write_merge(i, i, <span class="number">0</span>, <span class="number">1</span>, str(i+<span class="number">1</span>)+<span class="string">'-lucy'</span>, style)</span><br></pre></td></tr></table></figure></p>
<p><img src="https://cdn.nlark.com/yuque/0/2019/png/115449/1550216575067-e194aa06-0d7d-4265-a008-0629f9737122.png#align=left&amp;display=inline&amp;height=719&amp;linkTarget=_blank&amp;name=%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202019-02-15%2015.42.11.png&amp;originHeight=719&amp;originWidth=227&amp;size=66462&amp;width=227" alt="屏幕快照 2019-02-15 15.42.11.png"></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2019-02-14</span><i class="fa fa-tag"></i><a class="tag" href="/tags/Python/" title="Python">Python </a><a class="tag" href="/tags/xlrd/" title="xlrd">xlrd </a><a class="tag" href="/tags/xlwt/" title="xlwt">xlwt </a></div></div></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2019/02/14/去除Chrome浏览器下input黄色背景/" title="去除Chrome浏览器下input黄色背景">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2019/02/11/使用Python发送QQ邮件/" title="使用Python发送QQ邮件">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>