<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Lucy"><title>使用Python发送QQ邮件 · 长剑腥腥挂壁</title><meta name="description" content="SMTP是发送邮件的协议，Python内置对SMTP的支持，可以发送纯文本邮件、HTML邮件以及带附件的邮件Python对SMTP支持有smtplib和email两个模块，email负责构造邮件，smtplib负责发送邮件
发送QQ邮件python发送QQ邮件需要QQ邮箱的授权码
开启QQ邮箱SMT"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/logo-2.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo-2.png" style="width:127px;"><h3 title><a href="/">长剑腥腥挂壁</a></h3></div></div><ul class="social-links"></ul></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/logo-2.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>使用Python发送QQ邮件</a></h3></div><div class="post-content"><p>SMTP是发送邮件的协议，Python内置对SMTP的支持，可以发送纯文本邮件、HTML邮件以及带附件的邮件<br>Python对SMTP支持有<code>smtplib</code>和<code>email</code>两个模块，<code>email</code>负责构造邮件，<code>smtplib</code>负责发送邮件</p>
<h3 id="发送QQ邮件"><a href="#发送QQ邮件" class="headerlink" title="发送QQ邮件"></a>发送QQ邮件</h3><p>python发送QQ邮件需要QQ邮箱的授权码</p>
<h4 id="开启QQ邮箱SMTP服务，获得授权码"><a href="#开启QQ邮箱SMTP服务，获得授权码" class="headerlink" title="开启QQ邮箱SMTP服务，获得授权码"></a>开启QQ邮箱SMTP服务，获得授权码</h4><p>设置 -&gt; 帐号<br><img src="https://cdn.nlark.com/yuque/0/2019/png/115449/1549808802557-02370ec9-27cb-46ca-88a5-9a5456e3a372.png#align=left&amp;display=inline&amp;height=158&amp;linkTarget=_blank&amp;name=20190210220219.png&amp;originHeight=374&amp;originWidth=1186&amp;size=215923&amp;width=500" alt="20190210220219.png"></p>
<p>往下翻页可找到<strong>POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务</strong><br><img src="https://cdn.nlark.com/yuque/0/2019/jpeg/115449/1549808873926-77f0ea5c-afbc-4cdb-ac69-434d2b47d65f.jpeg#align=left&amp;display=inline&amp;height=159&amp;linkTarget=_blank&amp;name=22_19_27__02_10_2019.jpg&amp;originHeight=526&amp;originWidth=1654&amp;size=652969&amp;width=500" alt="22_19_27__02_10_2019.jpg"></p>
<p>点击开启，验证密保<br><img src="https://cdn.nlark.com/yuque/0/2019/jpeg/115449/1549808923604-80cf498a-6cec-4651-95ce-86a6ba9c48f6.jpeg#align=left&amp;display=inline&amp;height=243&amp;linkTarget=_blank&amp;name=22_20_54__02_10_2019.jpg&amp;originHeight=756&amp;originWidth=1554&amp;size=340818&amp;width=500" alt="22_20_54__02_10_2019.jpg"></p>
<p>获取授权码<br><img src="https://cdn.nlark.com/yuque/0/2019/jpeg/115449/1549808984974-844a5297-031a-47d6-a1d1-69a38dfa3e3d.jpeg#align=left&amp;display=inline&amp;height=257&amp;linkTarget=_blank&amp;name=22_22_13__02_10_2019.jpg&amp;originHeight=738&amp;originWidth=1434&amp;size=301450&amp;width=500" alt="22_22_13__02_10_2019.jpg"></p>
<h4 id="发送纯文本邮件"><a href="#发送纯文本邮件" class="headerlink" title="发送纯文本邮件"></a>发送纯文本邮件</h4><p>使用SSL的通用配置如下：<br>接收邮件服务器：pop.qq.com ,使用SSL,端口 995<br>发送邮件服务器： smtp.qq.com,使用SSL,端口 465或 587<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"><span class="keyword">from</span> email.mime.text <span class="keyword">import</span> MIMEText</span><br><span class="line"><span class="keyword">from</span> email.utils <span class="keyword">import</span> formataddr</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendEmail</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send_email</span><span class="params">(self)</span>:</span></span><br><span class="line">        mail_host=<span class="string">"smtp.qq.com"</span>           <span class="comment"># 设置服务器</span></span><br><span class="line">        mail_user=<span class="string">"*****@qq.com"</span>          <span class="comment"># 发送邮件的邮箱</span></span><br><span class="line">        mail_pass=<span class="string">"ebevmrxtzfbybfdi"</span>      <span class="comment"># 上一步获取的授权码</span></span><br><span class="line"></span><br><span class="line">        sender = <span class="string">'*****@qq.com'</span> 	<span class="comment"># 发送邮件的邮箱</span></span><br><span class="line">        receivers = <span class="string">'*****@icloud.com'</span>   <span class="comment"># 接收邮件的邮箱，可设置为你的QQ邮箱或者其他邮箱</span></span><br><span class="line"></span><br><span class="line">        message = MIMEText(<span class="string">'这是邮件内容，假装这里有点东西'</span>, <span class="string">'plain'</span>, <span class="string">'utf-8'</span>)    <span class="comment"># 邮件正文内容</span></span><br><span class="line">        <span class="comment"># 昵称便于让收件人知道发件人是谁</span></span><br><span class="line">        message[<span class="string">"From"</span>] = formataddr([<span class="string">"YUMI"</span>, <span class="string">'*****@qq.com'</span>]) <span class="comment"># 发件人昵称与邮箱</span></span><br><span class="line">        message[<span class="string">"To"</span>] = formataddr([<span class="string">"Lucy"</span>, <span class="string">'*****@icloud.com'</span>]) <span class="comment"># 收件人昵称与邮箱</span></span><br><span class="line">        message[<span class="string">'Subject'</span>] = <span class="string">'邮件标题'</span> <span class="comment"># 邮件标题</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            smtpObj = smtplib.SMTP_SSL(mail_host)</span><br><span class="line">            smtpObj.connect(mail_host, <span class="number">465</span>)        <span class="comment"># 25 为 SMTP 端口号  qq 465 587</span></span><br><span class="line">            smtpObj.login(mail_user, mail_pass)</span><br><span class="line">            smtpObj.sendmail(sender, receivers, message.as_string())</span><br><span class="line">            print(<span class="string">"邮件发送成功"</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> smtplib.SMTPException <span class="keyword">as</span> e:</span><br><span class="line">            print(<span class="string">"Error: 邮件发送失败"</span>)</span><br><span class="line">            print(e)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">notice = SendEmail()</span><br><span class="line">notice.send_email()</span><br></pre></td></tr></table></figure></p>
<p>发送结果<br><img src="https://cdn.nlark.com/yuque/0/2019/png/115449/1549883980853-b02242d4-54d1-47c3-a603-b00ee3b43eb6.png#align=left&amp;display=inline&amp;height=230&amp;linkTarget=_blank&amp;name=IMG_4934.PNG&amp;originHeight=431&amp;originWidth=750&amp;size=80485&amp;width=400" alt="IMG_4934.PNG"></p>
<h4 id="发送HTML邮件"><a href="#发送HTML邮件" class="headerlink" title="发送HTML邮件"></a>发送HTML邮件</h4><p>写一个html文件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>使用python发送QQ邮件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>SMTP是发送邮件的协议，Python内置对SMTP的支持，可以发送纯文本邮件、HTML邮件以及带附件的邮件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>Python对SMTP支持有<span class="tag">&lt;<span class="name">code</span>&gt;</span>smtplib<span class="tag">&lt;/<span class="name">code</span>&gt;</span>和<span class="tag">&lt;<span class="name">code</span>&gt;</span>email<span class="tag">&lt;/<span class="name">code</span>&gt;</span>两个模块，<span class="tag">&lt;<span class="name">code</span>&gt;</span>email<span class="tag">&lt;/<span class="name">code</span>&gt;</span>负责构造邮件，<span class="tag">&lt;<span class="name">code</span>&gt;</span>smtplib<span class="tag">&lt;/<span class="name">code</span>&gt;</span>负责发送邮件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span> <span class="attr">id</span>=<span class="string">"4a415f6d"</span>&gt;</span>发送QQ邮件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>python发送QQ邮件需要QQ邮箱的授权码<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h4</span> <span class="attr">id</span>=<span class="string">"918c165f"</span>&gt;</span>开启QQ邮箱SMTP服务，获得授权码<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>设置 -&amp;gt; 帐号<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">alt</span>=<span class="string">"20190210220219.png"</span> <span class="attr">src</span>=<span class="string">"https://cdn.nlark.com/yuque/0/2019/png/115449/1549808802557-02370ec9-27cb-46ca-88a5-9a5456e3a372.png#align=left&amp;amp;display=inline&amp;amp;height=158&amp;amp;linkTarget=_blank&amp;amp;name=20190210220219.png&amp;amp;originHeight=374&amp;amp;originWidth=1186&amp;amp;size=215923&amp;amp;width=500"</span> <span class="attr">style</span>=<span class="string">"max-width: 600px; width: 500px;"</span> /&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>读取该文件文本，发送<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">contents = <span class="string">''</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'email.html'</span>) <span class="keyword">as</span> file_obj:</span><br><span class="line">    contents = file_obj.read()</span><br><span class="line"></span><br><span class="line">print(contents)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SendEmail</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">send_email</span><span class="params">(self)</span>:</span></span><br><span class="line">        mail_host=<span class="string">"smtp.qq.com"</span>           <span class="comment"># 设置服务器</span></span><br><span class="line">        mail_user=<span class="string">"550502661@qq.com"</span>     <span class="comment"># 用户名</span></span><br><span class="line">        mail_pass=<span class="string">"ebevmrxtzfbybfdi"</span>      <span class="comment"># 口令(qq邮箱非密码)</span></span><br><span class="line"></span><br><span class="line">        sender = <span class="string">'550502661@qq.com'</span></span><br><span class="line">        receivers = <span class="string">'luchaoet@icloud.com'</span>   <span class="comment"># 接收邮箱，可设置为你的QQ邮箱或者其他邮箱</span></span><br><span class="line">        <span class="comment"># 发送html文件文本</span></span><br><span class="line">        message = MIMEText(contents, <span class="string">'html'</span>, <span class="string">'utf-8'</span>)</span><br><span class="line">        message[<span class="string">"From"</span>] = formataddr([<span class="string">"YUMI"</span>, <span class="string">'550502661@qq.com'</span>])</span><br><span class="line">        message[<span class="string">"To"</span>] = formataddr([<span class="string">"Lucy"</span>, <span class="string">'luchaoet@icloud.com'</span>])</span><br><span class="line">        message[<span class="string">'Subject'</span>] = <span class="string">'邮件标题'</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            smtpObj = smtplib.SMTP_SSL(mail_host)</span><br><span class="line">            smtpObj.connect(mail_host, <span class="number">465</span>)        <span class="comment"># 25 为 SMTP 端口号  qq 465 587</span></span><br><span class="line">            smtpObj.login(mail_user, mail_pass)</span><br><span class="line">            smtpObj.sendmail(sender, receivers, message.as_string())</span><br><span class="line">            print(<span class="string">"邮件发送成功"</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">except</span> smtplib.SMTPException <span class="keyword">as</span> e:</span><br><span class="line">            print(<span class="string">"Error: 无法发送邮件"</span>)</span><br><span class="line">            print(e)</span><br><span class="line">             </span><br><span class="line">notice = SendEmail()</span><br><span class="line">notice.send_email()</span><br></pre></td></tr></table></figure></p>
<p>发送结果<br><img src="https://cdn.nlark.com/yuque/0/2019/png/115449/1549888706162-eff14b6b-aaef-44f5-bbbc-e7a73f21ce50.png#align=left&amp;display=inline&amp;height=853&amp;linkTarget=_blank&amp;name=IMG_4936.PNG&amp;originHeight=1280&amp;originWidth=750&amp;size=171477&amp;width=500" alt="IMG_4936.PNG"></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2019-02-11</span><i class="fa fa-tag"></i><a class="tag" href="/tags/Python/" title="Python">Python </a><a class="tag" href="/tags/发送邮件/" title="发送邮件">发送邮件 </a></div></div></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2019/02/14/Python—xlrd和xlwt模块/" title="Python—xlrd和xlwt模块">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2019/02/04/Python—迭代器/" title="Python—迭代器">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>